<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fitness Aurora Final v11</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { aurora: { bg: '#020617' } },
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Space Grotesk', 'sans-serif'] },
                    animation: {
                        'aurora': 'aurora 20s ease infinite alternate',
                        'fade-in': 'fadeIn 0.3s ease-out forwards',
                        'pulse-slow': 'pulse 3s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'expand': 'expand 0.3s ease-in-out forwards'
                    },
                    keyframes: {
                        aurora: { '0%': { backgroundPosition: '0% 50%' }, '100%': { backgroundPosition: '100% 50%' } },
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        expand: { '0%': { maxHeight: '0px', opacity: '0' }, '100%': { maxHeight: '500px', opacity: '1' } }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone@7.26.9/babel.min.js"></script>

    <style>
        /* === GLOBAL LAYOUT === */
        html, body {
            margin: 0; padding: 0;
            background-color: #020617; color: #f1f5f9;
            width: 100%; height: 100%;
            overflow: hidden; /* Body –Ω–µ —Å–∫—Ä–æ–ª–ª–∏—Ç—Å—è */
            overscroll-behavior: none;
            -webkit-tap-highlight-color: transparent;
        }

        #root {
            height: 100%; width: 100%;
            overflow-y: auto; /* –°–∫—Ä–æ–ª–ª–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
            -webkit-overflow-scrolling: touch;
            display: flex; flex-direction: column;
            position: relative; z-index: 10;
        }

        /* –§–æ–Ω */
        .aurora-bg-dark {
            background: linear-gradient(-45deg, #020617, #1e1b4b, #111827, #0f172a);
            background-size: 400% 400%;
            position: fixed; inset: 0; z-index: 0;
            animation: aurora 15s ease infinite alternate;
        }

        .aurora-bg-light {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #312e81 100%); /* –°–¥–µ–ª–∞–ª —á—É—Ç—å —Ç–µ–º–Ω–µ–µ –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ —Ç–µ–∫—Å—Ç–∞ */
            background-size: 200% 200%;
            position: fixed; inset: 0; z-index: 0;
            animation: aurora 20s ease infinite alternate;
        }

        .glass-panel {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal-fullscreen {
            position: fixed; inset: 0; z-index: 100;
            background-color: #020617;
            display: flex; flex-direction: column;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div id="bg-layer" class="aurora-bg-dark"></div>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import { 
            Trophy, Diamond, Zap, Camera, CheckCircle, Activity, Settings, Plus, X, 
            Hexagon, Flame, Send, Bell, Skull, Dumbbell, Ruler, Star, Crown,
            BarChart3, Users, Calendar, ChevronDown, Shield, Edit3, Save, Trash2, ArrowLeft, Clock, UserPlus, Sun, Moon, Info 
        } from 'https://esm.sh/lucide-react@0.263.1';

        const GOOGLE_SCRIPT_URL = '–í–°–¢–ê–í–¨–¢–ï_–í–ê–®–£_–°–°–´–õ–ö–£_–°–Æ–î–ê'; 
        const ADMIN_USERNAME = 'solomin_d';
        const DEFAULT_START_DATE = new Date('2026-04-01');

        // --- UI COMPONENTS ---
        const GlassCard = ({ children, className = "", onClick }) => (
            <div onClick={onClick} className={`relative glass-panel rounded-3xl overflow-hidden ${onClick ? 'cursor-pointer active:scale-95 transition-transform' : ''} ${className}`}>
                {children}
            </div>
        );

        const NeonButton = ({ children, onClick, variant = 'primary', disabled = false, className = "" }) => {
            const v = { 
                primary: "bg-cyan-600 text-white shadow-lg shadow-cyan-500/20 border border-cyan-400/30", 
                danger: "bg-rose-600 text-white border-rose-400/30", 
                gold: "bg-amber-500 text-white border-amber-300/30", 
                secondary: "bg-white/10 text-white border border-white/20 hover:bg-white/20", 
                disabled: "bg-slate-800 text-slate-500 border-slate-700 cursor-not-allowed" 
            };
            return (
                <button onClick={onClick} disabled={disabled} className={`w-full py-4 font-bold tracking-wider uppercase rounded-2xl transition-all active:scale-95 flex items-center justify-center gap-2 ${disabled ? v.disabled : v[variant]} ${className}`}>
                    {children}
                </button>
            );
        };

        const Avatar = ({ name, photoUrl, size = "w-14 h-14" }) => {
            if (photoUrl) return <img src={photoUrl} alt={name} className={`${size} rounded-full object-cover border-2 border-white/20 shadow-md`} />;
            const initials = name ? name.slice(0, 2).toUpperCase() : "FQ";
            return <div className={`${size} rounded-full bg-gradient-to-br from-cyan-600 to-blue-700 flex items-center justify-center text-white font-bold border-2 border-white/20 shadow-md`}>{initials}</div>;
        };

        const ToggleSwitch = ({ checked, onChange }) => (
            <button onClick={() => onChange(!checked)} className={`w-12 h-7 rounded-full p-1 transition-colors ${checked ? 'bg-cyan-500' : 'bg-slate-700'}`}>
                <div className={`w-5 h-5 rounded-full bg-white transition-transform ${checked ? 'translate-x-5' : 'translate-x-0'}`} />
            </button>
        );

        const badgesData = [
            { id: 'streak', icon: <Flame size={14} />, color: 'text-orange-400', bg: 'bg-orange-500/20', label: '–ù–∞ –æ–≥–Ω–µ', desc: '–°—Ç—Ä–∏–∫ 3+ –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥' },
            { id: 'runner', icon: <Ruler size={14} />, color: 'text-cyan-400', bg: 'bg-cyan-500/20', label: '–ë–µ–≥—É–Ω', desc: '–ù–∞–±—Ä–∞–Ω–æ 10+ –∫–º' },
            { id: 'gym', icon: <Dumbbell size={14} />, color: 'text-purple-400', bg: 'bg-purple-500/20', label: '–¢–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä', desc: '5+ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –∑–∞–ª–µ' },
            { id: 'reps', icon: <Activity size={14} />, color: 'text-emerald-400', bg: 'bg-emerald-500/20', label: '–ú–∞—à–∏–Ω–∞', desc: '500+ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π' },
            { id: 'early', icon: <Sun size={14} />, color: 'text-amber-400', bg: 'bg-amber-500/20', label: '–ñ–∞–≤–æ—Ä–æ–Ω–æ–∫', desc: '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –¥–æ 8:00' },
            { id: 'night', icon: <Moon size={14} />, color: 'text-indigo-400', bg: 'bg-indigo-500/20', label: '–°–æ–≤–∞', desc: '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ø–æ—Å–ª–µ 22:00' },
            { id: 'weekend', icon: <Calendar size={14} />, color: 'text-rose-400', bg: 'bg-rose-500/20', label: '–í—ã—Ö–æ–¥–Ω–æ–π', desc: '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤ –°–±/–í—Å' },
            { id: 'social', icon: <Send size={14} />, color: 'text-blue-400', bg: 'bg-blue-500/20', label: '–î—Ä—É–≥', desc: '–ü—Ä–∏–≥–ª–∞—Å–∏–ª –¥—Ä—É–≥–∞' },
            { id: 'redemption', icon: <Skull size={14} />, color: 'text-slate-400', bg: 'bg-slate-500/20', label: '–í—ã–∂–∏–≤—à–∏–π', desc: '–ö—É–ø–∏–ª –∂–∏–∑–Ω—å' },
        ];

        // --- APP LOGIC ---
        function App() {
            // STATE
            const [step, setStep] = useState('loading');
            const [user, setUser] = useState({ firstName: '', lastName: '', username: '', telegramId: null, photoUrl: null, disciplines: [], goal: 0, diamonds: 3, streak: 0, todayActivity: [], history: [], status: 'active', notifications: true, notificationTime: '09:00', isAdmin: false, lastCheckInDate: null });
            const [marathonStartDate, setMarathonStartDate] = useState(DEFAULT_START_DATE);
            
            // UI
            const [regForm, setRegForm] = useState({ firstName: '', lastName: '' });
            const [popularSports, setPopularSports] = useState(['–ë–µ–≥', '–ó–∞–ª', '–û—Ç–∂–∏–º–∞–Ω–∏—è', '–ü–ª–∞–≤–∞–Ω–∏–µ', '–í–æ—Ä–∫–∞—É—Ç', '–í–µ–ª–æ']);
            const [dashboardView, setDashboardView] = useState('leaderboard'); 
            const [activeModal, setActiveModal] = useState(null); 
            const [expandedUserId, setExpandedUserId] = useState(null);
            const [badgeInfo, setBadgeInfo] = useState(null);

            // Inputs
            const [customInput, setCustomInput] = useState("");
            const [isAddingCustom, setIsAddingCustom] = useState(false);
            const [checkInCustomInput, setCheckInCustomInput] = useState("");
            const [isAddingInCheckIn, setIsAddingInCheckIn] = useState(false);

            // Check In
            const [checkInStage, setCheckInStage] = useState('select'); 
            const [selectedSportForCheckIn, setSelectedSportForCheckIn] = useState(null);
            const [checkInValue, setCheckInValue] = useState("");

            // Admin
            const [adminDateInput, setAdminDateInput] = useState('');
            const [editUser, setEditUser] = useState(null);
            const [isAddingUser, setIsAddingUser] = useState(false);
            const [newUserNick, setNewUserNick] = useState("");
            const [isSyncing, setIsSyncing] = useState(false);

            // Mock Data
            const [leaderboard, setLeaderboard] = useState([
                { id: 1, name: 'Alex', photoUrl: null, diamonds: 3, streak: 12, goal: 100, status: 'active', disciplines: ['–ë–µ–≥', '–í–æ—Ä–∫–∞—É—Ç'], history: [], badges: ['streak', 'runner'] },
                { id: 2, name: 'Elena', photoUrl: null, diamonds: 5, streak: 45, goal: 60, status: 'active', disciplines: ['–ó–∞–ª', '–ü–ª–∞–≤–∞–Ω–∏–µ'], history: [], badges: ['gym'] },
            ]);

            useEffect(() => {
                const tg = window.Telegram?.WebApp;
                if (tg) { 
                    tg.ready(); tg.expand(); 
                    tg.setHeaderColor('#020617'); tg.setBackgroundColor('#020617'); 
                    tg.enableClosingConfirmation(); 
                }
                
                const saved = localStorage.getItem('fitness_aurora_user');
                if(saved) { 
                    const parsed = JSON.parse(saved);
                    // Update user info
                    if(tg?.initDataUnsafe?.user) {
                        parsed.photoUrl = tg.initDataUnsafe.user.photo_url;
                        parsed.isAdmin = (tg.initDataUnsafe.user.username === ADMIN_USERNAME);
                    }
                    setUser(parsed); setStep('dashboard'); 
                } else { 
                    if (tg?.initDataUnsafe?.user) {
                        const tgu = tg.initDataUnsafe.user;
                        setRegForm({ firstName: tgu.first_name || '', lastName: tgu.last_name || '' });
                        setUser(prev => ({ ...prev, telegramId: tgu.id, username: tgu.username, photoUrl: tgu.photo_url, isAdmin: tgu.username === ADMIN_USERNAME }));
                    }
                    setStep('welcome'); 
                }

                if (GOOGLE_SCRIPT_URL.startsWith('http')) {
                    fetch(GOOGLE_SCRIPT_URL).then(r=>r.json()).then(d=>{ if(d.result==='success' && d.config?.MARATHON_START_DATE) { setMarathonStartDate(new Date(d.config.MARATHON_START_DATE)); setAdminDateInput(d.config.MARATHON_START_DATE); }});
                }
            }, []);

            // Theme Switcher
            useEffect(() => {
                const bg = document.getElementById('bg-layer');
                if (step === 'dashboard' || step === 'goal') {
                    bg.className = 'aurora-bg-light';
                } else {
                    bg.className = 'aurora-bg-dark';
                }
            }, [step]);

            useEffect(() => { if(user.firstName) localStorage.setItem('fitness_aurora_user', JSON.stringify(user)); }, [user]);

            // Logic
            const getAdjustedGoals = () => {
                const daysPassed = Math.max(0, Math.ceil((new Date() - marathonStartDate) / (86400000)));
                return [ 
                    { o: 30, r: Math.max(0, 30-daysPassed), l: '–ù–æ–≤–∏—á–æ–∫', i: <Star size={24} className="text-emerald-400"/> }, 
                    { o: 60, r: Math.max(0, 60-daysPassed), l: '–ê—Ç–ª–µ—Ç', i: <Dumbbell size={24} className="text-cyan-400"/> }, 
                    { o: 100, r: Math.max(0, 100-daysPassed), l: '–ö–∏–±–æ—Ä–≥', i: <Crown size={24} className="text-amber-400"/> } 
                ];
            };
            const getUserTitle = (g) => g>=100?'–ö–∏–±–æ—Ä–≥':g>=60?'–ê—Ç–ª–µ—Ç':'–ù–æ–≤–∏—á–æ–∫';
            const getStats = (hist) => { let k=0,r=0; hist.forEach(h=>{if(h.unit==='–∫–º')k+=+h.value;if(h.unit==='–ø–æ–≤—Ç')r+=+h.value;}); return {k,r}; };

            const toggleDiscipline = (s) => setUser(p => ({ ...p, disciplines: p.disciplines.includes(s) ? p.disciplines.filter(d => d !== s) : [...p.disciplines, s] }));
            
            const handleCheckInComplete = (val, unit) => {
                const sport = selectedSportForCheckIn;
                const todayStr = new Date().toDateString();
                const isNewDay = user.lastCheckInDate !== todayStr;
                setUser(prev => ({ 
                    ...prev, 
                    streak: isNewDay ? prev.streak + 1 : prev.streak, 
                    lastCheckInDate: todayStr,
                    todayActivity: [...prev.todayActivity, sport], 
                    history: [{date: new Date().toISOString(), sport, value: val, unit}, ...prev.history] 
                }));
                setActiveModal(null); setCheckInStage('select');
            };

            const addCustomSport = (name, checkIn = false) => {
                if(!name.trim()) return;
                setPopularSports(p => [...p, name]); 
                setUser(p => ({...p, disciplines: [...p.disciplines, name]}));
                if(checkIn) { setSelectedSportForCheckIn(name); setCheckInStage('value'); }
                setIsAddingCustom(false); setIsAddingInCheckIn(false); setCustomInput(""); setCheckInCustomInput("");
            };
            
            const handleAdminUpdate = async () => {
                if (!adminDateInput) return; setIsSyncing(true);
                try { setMarathonStartDate(new Date(adminDateInput)); await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'UPDATE_DATE', date: adminDateInput }) }); alert("–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!"); } catch (e) {} finally { setIsSyncing(false); }
            };

            const handleDeleteAccount = () => { if(confirm("–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç?")) { localStorage.removeItem('fitness_aurora_user'); window.location.reload(); } };

            // --- RENDER MODAL ---
            const ShopLogic = ({ onClose }) => {
                const [spinState, setSpinState] = useState('idle');
                const [task, setTask] = useState("");
                const tasks = ["–°–µ–ª—Ñ–∏ —Å –∫–æ—Ç–æ–º", "–ü–ª–∞–Ω–∫–∞ 1 –º–∏–Ω", "30 –ë–µ—Ä–ø–∏ –Ω–∞ –≤–∏–¥–µ–æ", "–°–º–µ—à–Ω–æ–µ –ª–∏—Ü–æ"];
                const spin = () => {
                    setSpinState('spinning');
                    let counter = 0;
                    const interval = setInterval(() => { setTask(tasks[counter % tasks.length]); counter++; }, 100);
                    setTimeout(() => { clearInterval(interval); setTask(tasks[Math.floor(Math.random() * tasks.length)]); setSpinState('result'); }, 2000);
                };
                return (
                    <GlassCard className="p-8 text-center border-rose-500/30 bg-rose-900/10 w-full">
                        <Skull className="mx-auto text-rose-500 mb-4" size={48}/>
                        <h3 className="text-2xl font-black text-white uppercase mb-2">–ö–£–ü–ò–¢–¨ –ñ–ò–ó–ù–¨</h3>
                        <p className="text-rose-400 text-sm mb-6">–¶–µ–Ω–∞: –¢–≤–æ—è –≥–æ—Ä–¥–æ—Å—Ç—å</p>
                        {spinState === 'idle' && <NeonButton variant="danger" onClick={spin}>–ö–†–£–¢–ò–¢–¨ –†–£–õ–ï–¢–ö–£</NeonButton>}
                        {spinState === 'spinning' && <div className="text-xl font-bold text-white animate-pulse">{task}</div>}
                        {spinState === 'result' && (<div className="animate-fade-in"><div className="text-lg font-bold text-white mb-4 border p-4 rounded-xl border-dashed border-rose-500/50 bg-rose-500/10">{task}</div><NeonButton onClick={() => setSpinState('upload')} variant="danger"><Camera size={18}/> –ó–ê–ì–†–£–ó–ò–¢–¨ –§–û–¢–û</NeonButton></div>)}
                        {spinState === 'upload' && (<div className="animate-fade-in"><div className="w-full h-32 bg-slate-800 rounded-xl flex items-center justify-center mb-4 border border-dashed border-slate-600"><span className="text-slate-500 text-xs">–§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ</span></div><NeonButton onClick={() => { alert("–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É!"); onClose(); }} variant="gold">–û–¢–ü–†–ê–í–ò–¢–¨</NeonButton></div>)}
                    </GlassCard>
                );
            }

            // --- SCREENS ---

            if (step === 'welcome') return (
                <div className="h-full flex flex-col items-center justify-center p-6 relative z-10 pt-20">
                    <div className="relative w-48 h-48 flex items-center justify-center mb-8"><div className="absolute inset-0 bg-cyan-500 blur-[80px] opacity-40 rounded-full animate-pulse"></div><Hexagon size={140} className="text-cyan-400 stroke-[1.5] animate-float" /><Activity size={60} className="text-white absolute" /></div>
                    <h1 className="text-5xl font-black text-white mb-2 text-center tracking-tighter">FITNESS<br/><span className="text-cyan-400">AURORA</span></h1>
                    <div className="mt-auto w-full max-w-xs pb-10"><NeonButton onClick={() => setStep('registration')}>–ù–ê–ß–ê–¢–¨</NeonButton></div>
                </div>
            );
            
            if (step === 'registration') return (
                <div className="p-6 pt-12 flex flex-col h-full overflow-y-auto">
                    <h2 className="text-3xl font-black text-white mb-8">–ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø</h2>
                    <div className="space-y-4 flex-grow">
                        <input placeholder="–ò–º—è" value={regForm.firstName} onChange={e => setRegForm({...regForm, firstName: e.target.value})} className="w-full p-5 bg-white/5 rounded-2xl text-white border border-white/10 outline-none focus:border-cyan-500 font-bold placeholder:text-slate-500" />
                        <input placeholder="–§–∞–º–∏–ª–∏—è" value={regForm.lastName} onChange={e => setRegForm({...regForm, lastName: e.target.value})} className="w-full p-5 bg-white/5 rounded-2xl text-white border border-white/10 outline-none focus:border-cyan-500 font-bold placeholder:text-slate-500" />
                    </div>
                    <NeonButton onClick={() => { setUser(p => ({...p, ...regForm})); setStep('arsenal'); }} disabled={!regForm.firstName}>–î–ê–õ–ï–ï</NeonButton>
                </div>
            );

            if (step === 'arsenal') return (
                <div className="p-6 pt-12 flex flex-col h-full overflow-y-auto">
                    <div className="flex justify-between items-center mb-2"><h2 className="text-3xl font-black text-white">–ê–†–°–ï–ù–ê–õ</h2><span className="text-sm font-mono text-cyan-400">{user.disciplines.length} –í–´–ë–†–ê–ù–û</span></div>
                    <p className="text-slate-400 text-sm mb-6">–í—ã–±–µ—Ä–∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã. –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ø–æ–∑–∂–µ.</p>
                    <div className="flex flex-wrap gap-3 mb-6">{popularSports.map(s => (<button key={s} onClick={() => toggleDiscipline(s)} className={`px-5 py-3 rounded-xl text-sm font-bold border transition-all ${user.disciplines.includes(s) ? 'bg-cyan-600/20 text-cyan-400 border-cyan-500' : 'bg-white/5 text-slate-400 border-white/10'}`}>{s}</button>))}</div>
                    {!isAddingCustom ? (
                        <button onClick={() => setIsAddingCustom(true)} className="w-full p-4 border border-dashed border-slate-600 rounded-xl text-slate-400 flex items-center justify-center gap-2 hover:border-cyan-500 hover:text-cyan-400 text-sm"><Plus size={18}/> –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é</button>
                    ) : (
                        <div className="flex gap-2 mb-4 animate-fade-in"><input value={customInput} onChange={e=>setCustomInput(e.target.value)} className="flex-1 bg-slate-900 border border-cyan-500 rounded-xl px-4 text-white outline-none" autoFocus placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ..." /><button onClick={()=>addCustomSport(customInput)} className="p-3 bg-cyan-600 rounded-xl text-white"><CheckCircle/></button></div>
                    )}
                    <div className="mt-auto pb-6"><NeonButton onClick={() => setStep('goal')} disabled={user.disciplines.length === 0}>–î–ê–õ–ï–ï</NeonButton></div>
                </div>
            );

            if (step === 'goal') return (
                <div className="p-6 pt-12 flex flex-col h-full overflow-y-auto">
                    <h2 className="text-3xl font-black text-white mb-8 text-center">–¢–í–û–Ø –¶–ï–õ–¨</h2>
                    <div className="space-y-4 flex-grow">
                        {getAdjustedGoals().map((g, idx) => (
                            <GlassCard key={idx} onClick={() => { setUser(p => ({...p, goal: g.o})); setStep('dashboard'); }} className="p-6 flex items-center justify-between group hover:border-cyan-500/50 transition-colors">
                                <div><span className="text-4xl font-black text-white">{g.r} <span className="text-sm font-medium text-slate-400">–î–Ω–µ–π</span></span><div className="text-xs text-cyan-400 uppercase mt-1 font-bold tracking-widest">{g.l}</div></div>
                                <div className="w-14 h-14 rounded-full bg-white/5 flex items-center justify-center border border-white/10 group-hover:bg-cyan-500/20 transition-colors">{g.i}</div>
                            </GlassCard>
                        ))}
                    </div>
                </div>
            );

            // --- DASHBOARD ---
            const progressPercent = Math.min((user.streak / user.goal) * 100, 100);
            
            return (
                <div className="flex flex-col min-h-full p-5 pt-8 space-y-6 pb-24">
                    
                    {/* PROFILE CARD */}
                    <GlassCard className="p-5">
                        <div className="flex justify-between items-start mb-5">
                            <div className="flex items-center gap-4">
                                <Avatar name={user.firstName} photoUrl={user.photoUrl} size="w-16 h-16" />
                                <div>
                                    <h1 className="text-2xl font-black text-white leading-none">{user.firstName}</h1>
                                    <div className="text-xs font-bold uppercase mt-1 tracking-wide"><span className="text-slate-500">–°—Ç–∞—Ç—É—Å: </span><span className="text-emerald-400">–í —Å—Ç—Ä–æ—é</span></div>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                {user.isAdmin && <button onClick={() => setActiveModal('admin')} className="w-10 h-10 flex items-center justify-center rounded-xl bg-amber-500/10 text-amber-500 border border-amber-500/30"><Shield size={18} /></button>}
                                <div onClick={() => setActiveModal('shop')} className="bg-white/5 border border-white/10 rounded-xl px-3 py-2 flex items-center gap-2 cursor-pointer"><Diamond size={16} className="text-cyan-400 fill-cyan-400" /><span className="font-bold text-white">{user.diamonds}</span></div>
                                <button onClick={() => setActiveModal('settings')} className="w-10 h-10 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 text-slate-400"><Settings size={18} /></button>
                            </div>
                        </div>
                        <div className="space-y-2">
                            <div className="flex justify-between text-[10px] font-bold text-slate-400 uppercase tracking-widest"><span>{user.streak} Days Streak</span><span>Goal: {user.goal}</span></div>
                            <div className="w-full bg-slate-800/50 h-2 rounded-full overflow-hidden relative"><div className="bg-gradient-to-r from-cyan-500 to-purple-500 h-full shadow-[0_0_15px_rgba(6,182,212,0.5)]" style={{ width: `${progressPercent}%` }}></div></div>
                        </div>
                    </GlassCard>

                    {/* MAIN ACTION */}
                    {user.todayActivity.length > 0 ? (
                        <GlassCard className="p-6 text-center bg-emerald-900/10 border-emerald-500/30">
                            <div className="inline-flex items-center justify-center w-14 h-14 rounded-full bg-emerald-500/10 mb-4 text-emerald-400 shadow-[0_0_20px_rgba(16,185,129,0.2)]"><CheckCircle size={28} /></div>
                            <h3 className="text-xl font-black text-white mb-4 tracking-wide uppercase">–î–ï–ù–¨ –ó–ê–°–ß–ò–¢–ê–ù</h3>
                            <div className="flex flex-wrap justify-center gap-2 mb-6">{user.todayActivity.map((act, i) => (<span key={i} className="px-4 py-1.5 bg-emerald-500/5 border border-emerald-500/20 rounded-lg text-xs font-bold text-emerald-300 uppercase tracking-wider">{act}</span>))}</div>
                            <button onClick={() => setActiveModal('checkIn')} className="w-full py-4 bg-white/5 border border-white/10 rounded-xl text-white font-bold hover:bg-white/10 flex items-center justify-center gap-2 text-xs uppercase tracking-widest transition-colors backdrop-blur-md"><Plus size={14}/> –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ</button>
                        </GlassCard>
                    ) : (
                        <button onClick={() => setActiveModal('checkIn')} className="w-full h-48 rounded-3xl glass-panel flex flex-col items-center justify-center gap-4 active:scale-98 transition-all group hover:border-cyan-500/40">
                            <div className="p-6 bg-cyan-500/10 rounded-full text-cyan-400 group-hover:scale-110 transition-transform animate-pulse-slow shadow-xl shadow-cyan-500/20"><Zap size={48} fill="currentColor" /></div>
                            <span className="text-3xl font-black text-white uppercase tracking-[0.2em] group-hover:text-cyan-300 transition-colors">–û–¢–ú–ï–¢–ò–¢–¨–°–Ø</span>
                        </button>
                    )}

                    {/* SWITCHER */}
                    <div className="flex justify-between items-center border-b border-white/10 pb-2">
                        <h3 className="text-xs font-bold text-slate-400 uppercase tracking-[0.2em]">{dashboardView === 'leaderboard' ? '–£–ß–ê–°–¢–ù–ò–ö–ò' : '–ú–û–ô –ü–†–û–ì–†–ï–°–°'}</h3>
                        <div className="flex gap-2">
                            <button onClick={() => setDashboardView('leaderboard')} className={`p-2 rounded-lg transition-all ${dashboardView === 'leaderboard' ? 'text-cyan-400 bg-cyan-900/20' : 'text-slate-600 hover:text-slate-400'}`}><Users size={20}/></button>
                            <button onClick={() => setDashboardView('progress')} className={`p-2 rounded-lg transition-all ${dashboardView === 'progress' ? 'text-cyan-400 bg-cyan-900/20' : 'text-slate-600 hover:text-slate-400'}`}><BarChart3 size={20}/></button>
                        </div>
                    </div>

                    {/* LISTS */}
                    {dashboardView === 'leaderboard' ? (
                        <div className="space-y-3 pb-10">{leaderboard.map((u, idx) => (
                            <GlassCard key={u.id} onClick={() => setExpandedUserId(expandedUserId === u.id ? null : u.id)} className="p-5 transition-all hover:bg-white/5">
                                <div className="flex items-center justify-between">
                                    <div className="flex items-center gap-4">
                                        <div className="relative"><Avatar name={u.name} photoUrl={u.photoUrl} size="w-10 h-10" /><div className="absolute -top-1 -right-1 bg-slate-900 rounded-full w-5 h-5 flex items-center justify-center text-[10px] font-bold border border-slate-700 text-white">{idx + 1}</div></div>
                                        <div>
                                            <div className="font-bold text-slate-200 text-lg">{u.name}</div>
                                            <div className="flex gap-1 mt-1.5">{u.badges?.slice(0, 4).map((bid) => { const b = badgesData.find(x=>x.id===bid); return b ? <div key={bid} className={`w-4 h-4 rounded-full flex items-center justify-center border ${b.bg} ${b.color}`}>{React.cloneElement(b.icon, {size:10})}</div> : null })}</div>
                                        </div>
                                    </div>
                                    <div className="flex items-center gap-4">
                                        <div className="text-right"><div className="font-black text-white text-lg">{u.streak} <span className="text-xs text-orange-400">üî•</span></div></div>
                                        <button onClick={(e) => { e.stopPropagation(); alert(`–ú–æ—Ç–∏–≤–∞—Ü–∏—è –¥–ª—è ${u.name}!`); }} className="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center text-cyan-400 hover:bg-cyan-500 hover:text-white transition-colors"><Zap size={18}/></button>
                                    </div>
                                </div>
                                {expandedUserId === u.id && (<div className="mt-5 pt-5 border-t border-white/5 animate-expand overflow-hidden"><div className="grid grid-cols-2 gap-3 mb-4"><div className="bg-white/5 p-3 rounded-xl text-center"><span className="text-[10px] uppercase text-slate-500 block mb-1">–ê–ª–º–∞–∑—ã</span><span className="font-bold text-white text-lg">{u.diamonds} üíé</span></div><div className="bg-white/5 p-3 rounded-xl text-center"><span className="text-[10px] uppercase text-slate-500 block mb-1">–¶–µ–ª—å</span><span className="font-bold text-white text-lg">{u.goal} –¥–Ω.</span></div></div><div className="flex flex-wrap gap-2">{u.disciplines?.map(d=><span key={d} className="text-xs px-3 py-1.5 bg-white/5 rounded-lg border border-white/10 text-slate-300 font-bold">{d}</span>)}</div></div>)}
                            </GlassCard>
                        ))}</div>
                    ) : (
                        <div className="space-y-6 pb-10">
                            <GlassCard className="p-6 grid grid-cols-2 gap-4"><div className="text-center"><Ruler className="mx-auto text-cyan-400 mb-2"/><div className="text-2xl font-black text-white">{getStats(user.history).k}</div><div className="text-[10px] text-slate-500 uppercase font-bold tracking-widest">–ö–ú –í—Å–µ–≥–æ</div></div><div className="text-center"><Dumbbell className="mx-auto text-purple-400 mb-2"/><div className="text-2xl font-black text-white">{getStats(user.history).r}</div><div className="text-[10px] text-slate-500 uppercase font-bold tracking-widest">–ü–æ–≤—Ç–æ—Ä–æ–≤</div></div></GlassCard>
                            <div><h3 className="text-slate-500 uppercase text-[10px] font-bold tracking-widest mb-4">–ê—á–∏–≤–∫–∏</h3><div className="grid gap-3 grid-cols-3">{badgesData.map(b => (<div key={b.id} onClick={() => setBadgeInfo(b)} className="flex flex-col items-center p-4 rounded-2xl border border-white/5 bg-white/5 text-center opacity-70 hover:opacity-100 transition-all cursor-pointer"><div className={`w-10 h-10 rounded-full flex items-center justify-center mb-3 border ${b.bg} ${b.color}`}>{b.icon}</div><div className="font-bold text-slate-300 text-[10px] uppercase">{b.label}</div></div>))}</div></div>
                            <div><h3 className="text-slate-500 uppercase text-[10px] font-bold tracking-widest mb-4">–ò—Å—Ç–æ—Ä–∏—è</h3><div className="space-y-3">{user.history.map((h,i)=>(<div key={i} className="flex justify-between p-4 bg-white/5 rounded-xl border border-white/5"><div className="flex items-center gap-3"><div className="w-1 h-8 bg-cyan-500 rounded-full"></div><div><div className="font-bold text-white">{h.sport}</div><div className="text-[10px] text-slate-500">{new Date(h.date).toLocaleDateString()}</div></div></div><div className="text-white font-bold text-lg">{h.value} <span className="text-xs text-slate-500 font-medium">{h.unit}</span></div></div>))}</div></div>
                        </div>
                    )}

                    {/* === MODALS === */}
                    
                    {activeModal === 'settings' && (
                        <div className="modal-fullscreen animate-fade-in">
                            <div className="p-6 pt-12 flex items-center gap-4 mb-4"><button onClick={()=>setActiveModal(null)} className="p-2 bg-white/10 rounded-full text-white"><ArrowLeft size={24}/></button><h2 className="text-2xl font-black text-white tracking-widest">–ù–ê–°–¢–†–û–ô–ö–ò</h2></div>
                            <div className="p-6 space-y-8 flex-1 overflow-y-auto">
                                <GlassCard className="p-5 space-y-5"><div className="flex justify-between items-center"><div className="flex items-center gap-3"><Bell className="text-cyan-400"/><span className="font-bold text-white">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span></div><ToggleSwitch checked={user.notifications} onChange={v=>setUser({...user, notifications:v})}/></div>{user.notifications && <div className="flex items-center gap-3 border-t border-white/10 pt-4"><Clock className="text-slate-400"/><input type="time" value={user.notificationTime} onChange={e=>setUser({...user, notificationTime:e.target.value})} className="bg-slate-900 text-white rounded p-2 text-sm outline-none"/><span className="text-xs text-slate-500">–í—Ä–µ–º—è</span></div>}</GlassCard>
                                <div><label className="text-slate-500 text-xs font-bold uppercase mb-4 block px-1">–ê—Ä—Å–µ–Ω–∞–ª</label><div className="flex flex-wrap gap-2 mb-4">{popularSports.map(s => (<button key={s} onClick={()=>toggleDiscipline(s)} className={`px-4 py-2 rounded-lg text-xs font-bold border ${user.disciplines.includes(s) ? 'bg-cyan-600/50 text-white border-cyan-500' : 'bg-white/5 text-slate-400 border-white/10'}`}>{s}</button>))}</div>{!isAddingCustom ? <button onClick={()=>setIsAddingCustom(true)} className="w-full p-4 border border-dashed border-slate-700 rounded-xl text-slate-500 text-sm font-bold uppercase hover:text-cyan-400 flex items-center justify-center gap-2"><Plus size={18}/> –î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é</button> : <div className="flex gap-2"><input value={customInput} onChange={e=>setCustomInput(e.target.value)} className="flex-1 bg-slate-900 border border-cyan-500 rounded-xl px-4 text-white outline-none" autoFocus placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" /><button onClick={()=>addCustomSport(customInput)} className="p-3 bg-cyan-600 rounded-xl text-white"><CheckCircle size={20}/></button></div>}</div>
                                <button onClick={handleDeleteAccount} className="w-full py-4 text-xs font-bold text-rose-500 border border-rose-500/30 bg-rose-500/10 rounded-xl uppercase flex items-center justify-center gap-2"><Trash2 size={16} /> –£–¥–∞–ª–∏—Ç—å –ê–∫–∫–∞—É–Ω—Ç</button>
                                <NeonButton onClick={()=>setActiveModal(null)} className="mt-8">–°–û–•–†–ê–ù–ò–¢–¨</NeonButton>
                            </div>
                        </div>
                    )}

                    {activeModal === 'admin' && (
                        <div className="modal-fullscreen animate-fade-in">
                            <div className="p-6 pt-12 flex items-center gap-4 mb-4"><button onClick={()=>setActiveModal(null)} className="p-3 bg-white/10 rounded-full text-white"><ArrowLeft size={24}/></button><h2 className="text-2xl font-black text-amber-500 tracking-widest flex items-center gap-2"><Shield/> ADMIN</h2></div>
                            <div className="p-6 space-y-6 flex-1 overflow-y-auto">
                                <GlassCard className="p-5"><div className="text-xs text-slate-500 uppercase mb-2">–î–∞—Ç–∞ –°—Ç–∞—Ä—Ç–∞</div><div className="flex flex-col gap-3"><div className="text-sm text-slate-400">–¢–µ–∫—É—â–∞—è: <span className="text-white font-mono bg-white/10 px-2 py-1 rounded">{marathonStartDate.toLocaleDateString()}</span></div><div className="flex gap-2 items-center"><input type="date" value={adminDateInput} onChange={e=>setAdminDateInput(e.target.value)} className="bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm flex-1"/><button onClick={handleAdminUpdate} className="p-3 bg-amber-500 rounded text-black"><Save size={20}/></button></div></div></GlassCard>
                                {!editUser ? (<div className="space-y-3"><h3 className="text-slate-400 text-xs font-bold uppercase">–£—á–∞—Å—Ç–Ω–∏–∫–∏</h3>{!isAddingUser ? <NeonButton variant="secondary" onClick={()=>setIsAddingUser(true)} className="mb-4"><UserPlus size={18}/> –î–æ–±–∞–≤–∏—Ç—å</NeonButton> : (<GlassCard className="p-4 mb-4 animate-fade-in"><input type="text" value={newUserNick} onChange={e=>setNewUserNick(e.target.value)} className="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white mb-3" placeholder="Nick"/><div className="flex gap-2"><NeonButton onClick={()=>setIsAddingUser(false)} variant="disabled">–û—Ç–º.</NeonButton><NeonButton onClick={()=>{if(newUserNick){setLeaderboard(l=>[...l, {id:Date.now(), name:newUserNick, diamonds:3, streak:0, goal:30, status:'active'}]); setIsAddingUser(false); setNewUserNick('')}}}>OK</NeonButton></div></GlassCard>)}{leaderboard.map(u=><div key={u.id} className="flex justify-between items-center p-4 bg-white/5 rounded-xl border border-white/10"><span className="text-white font-bold text-lg">{u.name}</span><div className="flex gap-2"><button onClick={()=>setEditUser({...u})} className="p-2 bg-cyan-500/20 text-cyan-400 rounded-lg"><Edit3 size={18}/></button><button onClick={()=>{if(confirm('Del?'))setLeaderboard(l=>l.filter(x=>x.id!==u.id))}} className="p-2 bg-rose-500/20 text-rose-400 rounded-lg"><Trash2 size={18}/></button></div></div>)}</div>) : (<GlassCard className="p-5 space-y-4 animate-fade-in"><h3 className="text-white font-bold mb-2 text-xl">Edit {editUser.name}</h3><input type="number" value={editUser.diamonds} onChange={e=>setEditUser({...editUser, diamonds: +e.target.value})} className="w-full bg-slate-900 p-3 text-white rounded-lg" placeholder="Diamonds"/><input type="number" value={editUser.streak} onChange={e=>setEditUser({...editUser, streak: +e.target.value})} className="w-full bg-slate-900 p-3 text-white rounded-lg" placeholder="Streak"/><div className="flex gap-2 pt-2"><NeonButton variant="disabled" onClick={()=>setEditUser(null)}>Back</NeonButton><NeonButton onClick={adminSaveUserChanges}>Save</NeonButton></div></GlassCard>)}
                            </div>
                        </div>
                    )}

                    {activeModal === 'shop' && (
                        <div className="modal-fullscreen animate-slide-up">
                            <div className="p-6 pt-12 flex items-center gap-4 mb-4"><button onClick={()=>setActiveModal(null)} className="p-2 bg-white/10 rounded-full text-white"><ArrowLeft size={20}/></button><h2 className="text-xl font-bold text-rose-500 ml-4">–ú–ê–ì–ê–ó–ò–ù</h2></div>
                            <div className="flex-1 flex items-center justify-center p-6">
                                <ShopLogic onClose={()=>setActiveModal(null)} />
                            </div>
                        </div>
                    )}

                    {activeModal === 'checkIn' && (
                        <div className="fixed inset-0 z-[70] bg-black/80 backdrop-blur-md flex items-end sm:items-center justify-center p-4 animate-fade-in"><div className="w-full max-w-md bg-[#0f172a] border border-white/10 rounded-t-3xl p-6 sm:rounded-3xl">
                            {checkInStage === 'select' && (<><div className="flex justify-between items-center mb-6"><h3 className="text-lg font-bold text-white">–ß–¢–û –°–î–ï–õ–ê–ù–û?</h3><button onClick={() => setActiveModal(null)}><X className="text-slate-500" /></button></div><div className="space-y-3 mb-6 max-h-64 overflow-y-auto">{user.disciplines.map(s => (<button key={s} onClick={() => { setSelectedSportForCheckIn(s); if(s.toLowerCase().includes('–∑–∞–ª')||s.toLowerCase().includes('gym')){setCheckInStage('gym_options')}else{setCheckInStage('value')} }} className="w-full p-5 bg-white/5 rounded-2xl text-left font-bold text-slate-300 hover:bg-cyan-500/10 hover:text-cyan-400 flex justify-between transition-colors">{s} <ChevronDown className="-rotate-90 text-slate-600" size={20}/></button>))}</div>{!isAddingInCheckIn ? (<button onClick={() => setIsAddingInCheckIn(true)} className="w-full p-4 border border-dashed border-slate-700 rounded-xl text-slate-500 font-bold hover:text-cyan-400 flex items-center justify-center gap-2"><Plus size={18}/> –°–≤–æ—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞</button>) : (<div className="flex gap-2 animate-fade-in"><input type="text" value={checkInCustomInput} onChange={e => setCheckInCustomInput(e.target.value)} placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ..." className="flex-1 p-4 bg-slate-900 border border-cyan-500 rounded-xl text-white outline-none" autoFocus /><button onClick={handleAddCustomFromCheckIn} className="p-4 bg-cyan-600 rounded-xl text-white shadow-lg"><CheckCircle size={24}/></button></div>)}</>)}
                            {checkInStage === 'gym_options' && (<div className="text-center mt-4"><h3 className="text-xl font-bold text-white mb-8">–ß–¢–û –ö–ê–ß–ê–õ?</h3><div className="grid grid-cols-2 gap-4 mb-8">{['–í—Å—ë —Ç–µ–ª–æ', '–í–µ—Ä—Ö', '–ù–∏–∑', '–ì–æ–ª–æ–≤–æ–π'].map(opt => (<button key={opt} onClick={() => { setCheckInValue(opt); handleCheckInComplete(opt, '—Ç–∏–ø'); }} className="p-5 bg-white/5 border border-white/10 rounded-2xl text-slate-200 font-bold hover:bg-cyan-600 hover:text-white transition-colors">{opt}</button>))}</div><NeonButton variant="disabled" onClick={() => setCheckInStage('select')}>–ù–∞–∑–∞–¥</NeonButton></div>)}
                            {checkInStage === 'value' && (<div className="text-center mt-4"><h3 className="text-xl font-bold text-white mb-8">{selectedSportForCheckIn}</h3><div className="flex items-end justify-center gap-2 mb-10"><input type="number" autoFocus onChange={e => setCheckInValue(e.target.value)} className="bg-transparent border-b-2 border-slate-700 text-center text-6xl font-black text-white w-40 outline-none focus:border-cyan-500" placeholder="0" /><span className="text-slate-500 font-bold mb-2 text-xl">–ï–î.</span></div><div className="flex gap-3"><NeonButton variant="disabled" onClick={() => setCheckInStage('select')}>–ù–∞–∑–∞–¥</NeonButton><NeonButton onClick={() => handleCheckInComplete(checkInValue, 'units')} disabled={!checkInValue}>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</NeonButton></div></div>)}
                        </div></div>
                    )}

                    {badgeInfo && (
                        <div className="fixed inset-0 z-[80] bg-black/80 backdrop-blur-md flex items-center justify-center p-6 animate-fade-in" onClick={()=>setBadgeInfo(null)}><div className="bg-[#0f172a] border border-white/10 rounded-3xl p-8 text-center max-w-sm w-full" onClick={e=>e.stopPropagation()}><div className={`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 border ${badgeInfo.bg} ${badgeInfo.color}`}>{React.cloneElement(badgeInfo.icon, {size:40})}</div><h3 className="text-2xl font-black text-white mb-2">{badgeInfo.label}</h3><p className="text-slate-400 mb-8 leading-relaxed">{badgeInfo.desc}</p><NeonButton variant="secondary" onClick={()=>setBadgeInfo(null)}>–ü–û–ù–Ø–¢–ù–û</NeonButton></div></div>
                    )}
                </div>
            );
        }

        const ShopLogic = ({ onClose }) => {
            const [spinState, setSpinState] = useState('idle');
            const [task, setTask] = useState("");
            const tasks = ["–°–µ–ª—Ñ–∏ —Å –∫–æ—Ç–æ–º", "–ü–ª–∞–Ω–∫–∞ 1 –º–∏–Ω", "30 –ë–µ—Ä–ø–∏ –Ω–∞ –≤–∏–¥–µ–æ", "–°–º–µ—à–Ω–æ–µ –ª–∏—Ü–æ"];
            const spin = () => {
                setSpinState('spinning');
                let counter = 0;
                const interval = setInterval(() => { setTask(tasks[counter % tasks.length]); counter++; }, 100);
                setTimeout(() => { clearInterval(interval); setTask(tasks[Math.floor(Math.random() * tasks.length)]); setSpinState('result'); }, 2000);
            };
            return (
                <GlassCard className="p-8 text-center border-rose-500/30 bg-rose-900/10 w-full">
                    <Skull className="mx-auto text-rose-500 mb-4" size={48}/>
                    <h3 className="text-2xl font-black text-white uppercase mb-2">–ö–£–ü–ò–¢–¨ –ñ–ò–ó–ù–¨</h3>
                    <p className="text-rose-400 text-sm mb-6">–¶–µ–Ω–∞: –¢–≤–æ—è –≥–æ—Ä–¥–æ—Å—Ç—å</p>
                    {spinState === 'idle' && <NeonButton variant="danger" onClick={spin}>–ö–†–£–¢–ò–¢–¨ –†–£–õ–ï–¢–ö–£</NeonButton>}
                    {spinState === 'spinning' && <div className="text-xl font-bold text-white animate-pulse">{task}</div>}
                    {spinState === 'result' && (<div className="animate-fade-in"><div className="text-lg font-bold text-white mb-4 border p-4 rounded-xl border-dashed border-rose-500/50 bg-rose-500/10">{task}</div><NeonButton onClick={() => setSpinState('upload')} variant="danger"><Camera size={18}/> –ó–ê–ì–†–£–ó–ò–¢–¨ –§–û–¢–û</NeonButton></div>)}
                    {spinState === 'upload' && (<div className="animate-fade-in"><div className="w-full h-32 bg-slate-800 rounded-xl flex items-center justify-center mb-4 border border-dashed border-slate-600"><span className="text-slate-500 text-xs">–§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ</span></div><NeonButton onClick={() => { alert("–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É!"); onClose(); }} variant="gold">–û–¢–ü–†–ê–í–ò–¢–¨</NeonButton></div>)}
                </GlassCard>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
